<script>
  // 커스텀 카테고리 함수 시작
    // '임시' 링크 클릭 이벤트 리스너 추가
    document.addEventListener("DOMContentLoaded", function() {
    document.querySelector('#temp').addEventListener(
        "click", function(event) {
        alert("클릭")
        event.preventDefault(); // 기본 동작 방지
        addCustomMarker(); // 함수 호출
    });
    });

    // 마커 추가 함수
    function addCustomMarker() {
        let noonlat = 37.54648279144811;
        let noonlng = 126.90856933593791;
        let customKeyword = "커스텀"
        addMarker(noonlat, noonlng, customKeyword); // 특정 위치에 마커 추가
        document.getElementById("searchKeyword").value = ""; // 검색창 초기화
        document.getElementById("searchResult").innerHTML = ""; // 검색 결과 초기화
        updateCategoryImage(customKeyword); // 카테고리 이미지 초기화
    }
    

    function addMarker(noonlat, noonlng, customKeyword) {
    clearMarkers(); // 이전 마커 제거
    var innerHtml = ""; // searchResult 결과값 노출 위한 변수
    var markerImage = getMarkerImage(customKeyword);
    // 좌표 객체 생성 및 EPSG3857 좌표계를 WGS84GEO 좌표계로 변환
    var pointCng = new Tmapv2.Point(noonlat, noonlng);
    console.log(pointCng.getX())
    console.log(pointCng.getY())
    //var projectionCng = Tmapv2.Projection.convertEPSG3857ToWGS84GEO(pointCng);
    //var lat = projectionCng._lat;
    //var lng = projectionCng._lng;
    
    var markerPosition = new Tmapv2.LatLng(noonlat, noonlng);
    //console.log("lat : "+markerPosition.lat())
    //console.log("lon : "+markerPosition.lng())
    var positionBounds = new Tmapv2.LatLngBounds(); // LatLngBounds 객체 초기화
    var currentCenter = map.getCenter();
    //console.log("center : " + currentCenter);
    var id = 0;

    var marker = new Tmapv2.Marker({
        name: "custom",
        position: markerPosition, // 마커 위치
        icon: markerImage, // 카테고리에 맞는 마커 이미지 사용
        iconSize: new Tmapv2.Size(50, 50), // 마커 크기 (24x35)
        title: customKeyword, // 마커 제목
        map: map // 지도에 마커 등록
    });
    console.log(marker);
    marker.setPosition(markerPosition);
    innerHtml += "<li><div><img src='" + markerImage + "' style='vertical-align:middle;' class='marker-img'>&nbsp;&nbsp;<span>"
                + customKeyword
                + "</span>  <button type='button' name='sendBtn' onClick='poiDetail(" + id + ");'>상세보기</button></div></li><br>";
    
    markerArr.push(marker); // 추가된 마커를 배열에 저장
    positionBounds.extend(markerPosition);   // LatLngBounds 확장ㅇ
    console.log("bound2 : " + positionBounds);

    if (markerArr.length > 0) {
        // 현재 맵의 줌 레벨을 저장
        var currentZoom = map.getZoom();

        // 마커들이 생성되었을 때만 중심을 설정하고 확대하지 않음
        var centerPosition = markerArr[0].getPosition(); // 첫 번째 마커 위치로 맵 중심 설정
        map.setCenter(currentCenter);

        // 기존 줌 레벨을 유지
        map.setZoom(currentZoom);
    }
}
</script>